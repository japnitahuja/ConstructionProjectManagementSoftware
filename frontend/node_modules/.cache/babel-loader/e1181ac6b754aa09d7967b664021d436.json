{"ast":null,"code":"import { all, call, put, takeLatest, select, delay } from \"redux-saga/effects\";\nimport { UpdatePublishedInProjectFailure, UpdatePublishedInProjectSuccess, deleteCurrentProjectFailure, deleteCurrentProjectSuccess, fetchCurrentProjectFailure, fetchCurrentProjectStart, fetchCurrentProjectSuccess, inviteUserFailure, inviteUserSuccess, UpdateUserInProjectFailure, UpdateUserInProjectSuccess, UpdateRolesInProjectSuccess, UpdateRolesInProjectFailure, deleteUserSuccess, deleteUserFailure } from \"./current-project.actions\";\nimport { CurrentProjectActionTypes } from \"./current-project.types\";\nimport { selectUserId } from \"../user/user.selectors\";\nimport { deleteProject } from \"../all-projects/all-projects.actions\";\nimport { selectCurrentProjectId } from \"./current-project.selectors\";\nimport currentProjectReducer from \"./current-project.reducer\";\nimport { setUserPermission } from \"../user/user.actions\";\nimport { selectCurrentOrganisationId } from \"../organisation/organisation.selectors\";\nexport function* fetchCurrentProject({\n  payload\n}) {\n  try {\n    const projectId = payload;\n    const userId = yield select(selectUserId);\n    const token = localStorage.getItem(\"token\");\n    let currentProject = yield fetch(`http://127.0.0.1:5000/project/${projectId}`, {\n      method: \"GET\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        role: \"ADMIN\",\n        authorization: `Bearer ${token}`\n      }\n    });\n    currentProject = yield currentProject.json();\n    console.log(\"saga\", currentProject);\n    currentProject.done ? yield put(fetchCurrentProjectSuccess(currentProject.project)) : yield put(fetchCurrentProjectFailure(\"CURRENT PROJECCT FETTCHING FAILED\"));\n  } catch (error) {\n    fetchCurrentProjectFailure(error);\n  }\n}\nexport function* deleteCurrentProject({\n  payload\n}) {\n  try {\n    const projectId = payload;\n    console.log(projectId);\n    yield put(deleteProject(projectId));\n    let userId = yield select(selectUserId);\n    userId = {\n      userId: userId\n    };\n    console.log(userId);\n    let projectDeletion = yield fetch(`http://127.0.0.1:5000/project/${projectId}`, {\n      method: \"DELETE\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(userId)\n    });\n    projectDeletion = yield projectDeletion.json();\n    projectDeletion.done ? yield put(deleteCurrentProjectSuccess(projectDeletion.message)) : yield put(deleteCurrentProjectFailure(projectDeletion.error));\n  } catch (error) {\n    console.log(error);\n    deleteCurrentProjectFailure(error);\n    console.log(error);\n  }\n}\nexport function* deleteUser({\n  payload\n}) {\n  try {\n    const {\n      projectId,\n      userId\n    } = payload;\n    const organisationId = yield select(selectCurrentOrganisationId);\n    let data = {\n      userId,\n      organisationId\n    };\n    console.log(data, payload);\n    let userDeletion = yield fetch(`http://127.0.0.1:5000/deleteUser/${projectId}`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(data)\n    });\n    userDeletion = yield userDeletion.json();\n    userDeletion.done ? yield put(deleteUserSuccess(userDeletion.message)) : yield put(deleteUserFailure(userDeletion.error));\n  } catch (error) {\n    console.log(error);\n    deleteUserFailure(error);\n    console.log(error);\n  }\n}\nexport function* inviteUser({\n  payload\n}) {\n  try {\n    let data = payload;\n    let projectId = yield select(selectCurrentProjectId);\n    data[\"projectId\"] = projectId;\n    let resp = yield fetch(\"http://127.0.0.1:5000/inviteUser\", {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(data)\n    });\n    resp = yield resp.json();\n\n    if (resp.done) {\n      yield put(inviteUserSuccess(resp.message));\n      yield put(fetchCurrentProjectStart(projectId));\n    } else {\n      yield put(inviteUserFailure(resp.message));\n    }\n  } catch (error) {\n    console.log(error);\n    yield put(inviteUserFailure(error));\n  }\n}\nexport function* updateUserInProject({\n  payload\n}) {\n  try {\n    let data = payload;\n    let projectId = yield select(selectCurrentProjectId);\n    console.log(data, \"saga data\");\n    console.log(projectId);\n    let resp = yield fetch(`http://127.0.0.1:5000/updatePermissions/${projectId}`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(data)\n    });\n    resp = yield resp.json();\n\n    if (resp.done) {\n      yield put(UpdateUserInProjectSuccess(resp.message));\n      yield delay(500);\n      yield put(fetchCurrentProjectStart(projectId));\n    } else {\n      yield put(UpdateUserInProjectFailure(resp.message));\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\nexport function* updatePublishedInProject() {\n  try {\n    console.log(\"Inside update published saga\");\n    let projectId = yield select(selectCurrentProjectId);\n    let resp = yield fetch(`http://127.0.0.1:5000/publish/${projectId}`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    });\n    resp = yield resp.json();\n\n    if (resp.done) {\n      yield put(UpdatePublishedInProjectSuccess(resp.message));\n      yield delay(500);\n      yield put(fetchCurrentProjectStart(projectId));\n    } else {\n      yield put(UpdatePublishedInProjectFailure(resp.message));\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\nexport function* updateRoles({\n  payload\n}) {\n  try {\n    let data = payload;\n    let projectId = yield select(selectCurrentProjectId);\n    let resp = yield fetch(`http://127.0.0.1:5000/updateRoles/${projectId}`, {\n      method: \"POST\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      },\n      body: JSON.stringify(data)\n    });\n    resp = yield resp.json();\n\n    if (resp.done) {\n      yield put(UpdateRolesInProjectSuccess(resp.message));\n      yield delay(500);\n      yield put(fetchCurrentProjectStart(projectId));\n    } else {\n      yield put(UpdateRolesInProjectFailure(resp.message));\n    }\n  } catch (error) {\n    console.log(error);\n  }\n}\nexport function* onCurrentProjectFetchStart() {\n  yield takeLatest(CurrentProjectActionTypes.FETCH_CURRENT_PROJECT_START, fetchCurrentProject);\n}\nexport function* onCurrentProjectDeleteStart() {\n  yield takeLatest(CurrentProjectActionTypes.DELETE_CURRENT_PROJECT_START, deleteCurrentProject);\n}\nexport function* onInviteUserStart() {\n  yield takeLatest(CurrentProjectActionTypes.INVITE_USER_START, inviteUser);\n}\nexport function* onUpdateUserStart() {\n  yield takeLatest(CurrentProjectActionTypes.UPDATE_USER_IN_PROJECT_START, updateUserInProject);\n}\nexport function* onDeleteUserStart() {\n  yield takeLatest(CurrentProjectActionTypes.DELETE_USER_START, deleteUser);\n}\nexport function* onUpdateRolesStart() {\n  yield takeLatest(CurrentProjectActionTypes.UPDATE_ROLES_IN_PROJECT_START, updateRoles);\n}\nexport function* onUpdatePublishedStart() {\n  yield takeLatest(CurrentProjectActionTypes.UPDATE_PUBLISHED_IN_PROJECT_START, updatePublishedInProject);\n}\nexport function* currentProjectSagas() {\n  yield all([call(onCurrentProjectFetchStart), call(onCurrentProjectDeleteStart), call(onInviteUserStart), call(onUpdateUserStart), call(onUpdatePublishedStart), call(onUpdateRolesStart), call(onDeleteUserStart)]);\n}","map":{"version":3,"sources":["C:/Users/lenovo/Desktop/GitHub/myles-website/frontend/src/redux/current-project/current-project.sagas.js"],"names":["all","call","put","takeLatest","select","delay","UpdatePublishedInProjectFailure","UpdatePublishedInProjectSuccess","deleteCurrentProjectFailure","deleteCurrentProjectSuccess","fetchCurrentProjectFailure","fetchCurrentProjectStart","fetchCurrentProjectSuccess","inviteUserFailure","inviteUserSuccess","UpdateUserInProjectFailure","UpdateUserInProjectSuccess","UpdateRolesInProjectSuccess","UpdateRolesInProjectFailure","deleteUserSuccess","deleteUserFailure","CurrentProjectActionTypes","selectUserId","deleteProject","selectCurrentProjectId","currentProjectReducer","setUserPermission","selectCurrentOrganisationId","fetchCurrentProject","payload","projectId","userId","token","localStorage","getItem","currentProject","fetch","method","headers","role","authorization","json","console","log","done","project","error","deleteCurrentProject","projectDeletion","body","JSON","stringify","message","deleteUser","organisationId","data","userDeletion","inviteUser","resp","updateUserInProject","updatePublishedInProject","updateRoles","onCurrentProjectFetchStart","FETCH_CURRENT_PROJECT_START","onCurrentProjectDeleteStart","DELETE_CURRENT_PROJECT_START","onInviteUserStart","INVITE_USER_START","onUpdateUserStart","UPDATE_USER_IN_PROJECT_START","onDeleteUserStart","DELETE_USER_START","onUpdateRolesStart","UPDATE_ROLES_IN_PROJECT_START","onUpdatePublishedStart","UPDATE_PUBLISHED_IN_PROJECT_START","currentProjectSagas"],"mappings":"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","sourcesContent":["import { all, call, put, takeLatest, select, delay } from \"redux-saga/effects\";\r\nimport {\r\n  UpdatePublishedInProjectFailure,\r\n  UpdatePublishedInProjectSuccess,\r\n  deleteCurrentProjectFailure,\r\n  deleteCurrentProjectSuccess,\r\n  fetchCurrentProjectFailure,\r\n  fetchCurrentProjectStart,\r\n  fetchCurrentProjectSuccess,\r\n  inviteUserFailure,\r\n  inviteUserSuccess,\r\n  UpdateUserInProjectFailure,\r\n  UpdateUserInProjectSuccess,\r\n  UpdateRolesInProjectSuccess,\r\n  UpdateRolesInProjectFailure,\r\n  deleteUserSuccess,\r\n  deleteUserFailure\r\n} from \"./current-project.actions\";\r\nimport { CurrentProjectActionTypes } from \"./current-project.types\";\r\nimport { selectUserId } from \"../user/user.selectors\";\r\nimport { deleteProject } from \"../all-projects/all-projects.actions\";\r\nimport { selectCurrentProjectId } from \"./current-project.selectors\";\r\nimport currentProjectReducer from \"./current-project.reducer\";\r\nimport { setUserPermission } from \"../user/user.actions\";\r\nimport { selectCurrentOrganisationId } from \"../organisation/organisation.selectors\";\r\n\r\nexport function* fetchCurrentProject({ payload }) {\r\n  try {\r\n    const projectId = payload;\r\n    const userId = yield select(selectUserId);\r\n    const token = localStorage.getItem(\"token\");\r\n    let currentProject = yield fetch(\r\n      `http://127.0.0.1:5000/project/${projectId}`,\r\n      {\r\n        method: \"GET\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          role: \"ADMIN\",\r\n          authorization: `Bearer ${token}`,\r\n        },\r\n      }\r\n    );\r\n    currentProject = yield currentProject.json();\r\n \r\n    console.log(\"saga\", currentProject);\r\n    currentProject.done\r\n      ? yield put(fetchCurrentProjectSuccess(currentProject.project))\r\n      : yield put(\r\n          fetchCurrentProjectFailure(\"CURRENT PROJECCT FETTCHING FAILED\")\r\n        );\r\n  } catch (error) {\r\n    fetchCurrentProjectFailure(error);\r\n  }\r\n}\r\n\r\nexport function* deleteCurrentProject({ payload }) {\r\n  try {\r\n    const projectId = payload;\r\n    console.log(projectId);\r\n    yield put(deleteProject(projectId));\r\n    let userId = yield select(selectUserId);\r\n    userId = { userId: userId };\r\n    console.log(userId);\r\n    let projectDeletion = yield fetch(\r\n      `http://127.0.0.1:5000/project/${projectId}`,\r\n      {\r\n        method: \"DELETE\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(userId),\r\n      }\r\n    );\r\n    projectDeletion = yield projectDeletion.json();\r\n    projectDeletion.done\r\n      ? yield put(deleteCurrentProjectSuccess(projectDeletion.message))\r\n      : yield put(deleteCurrentProjectFailure(projectDeletion.error));\r\n  } catch (error) {\r\n    console.log(error);\r\n    deleteCurrentProjectFailure(error);\r\n    console.log(error);\r\n  }\r\n}\r\n\r\nexport function* deleteUser({ payload }) {\r\n  try {\r\n    const {projectId, userId} = payload;\r\n    const organisationId = yield select(selectCurrentOrganisationId)\r\n    let data = {\r\n      userId,\r\n      organisationId\r\n    }\r\n    console.log(data, payload)\r\n\r\n    let userDeletion = yield fetch(\r\n      `http://127.0.0.1:5000/deleteUser/${projectId}`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(data)\r\n      }\r\n    );\r\n   \r\n    \r\n    userDeletion = yield userDeletion.json();\r\n    \r\n    userDeletion.done\r\n      ? yield put(deleteUserSuccess(userDeletion.message))\r\n      : yield put(deleteUserFailure(userDeletion.error));\r\n  } catch (error) {\r\n    console.log(error);\r\n    deleteUserFailure(error);\r\n    console.log(error);\r\n  }\r\n}\r\n\r\nexport function* inviteUser({ payload }) {\r\n  try {\r\n    let data = payload;\r\n    let projectId = yield select(selectCurrentProjectId);\r\n    data[\"projectId\"] = projectId;\r\n    let resp = yield fetch(\"http://127.0.0.1:5000/inviteUser\", {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(data),\r\n    });\r\n\r\n    resp = yield resp.json();\r\n    if (resp.done) {\r\n      yield put(inviteUserSuccess(resp.message));\r\n      yield put(fetchCurrentProjectStart(projectId));\r\n    } else {\r\n      yield put(inviteUserFailure(resp.message));\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n    yield put(inviteUserFailure(error));\r\n  }\r\n}\r\n\r\nexport function* updateUserInProject({ payload }) {\r\n  try {\r\n    let data = payload;\r\n    let projectId = yield select(selectCurrentProjectId);\r\n    console.log(data, \"saga data\");\r\n    console.log(projectId);\r\n    let resp = yield fetch(\r\n      `http://127.0.0.1:5000/updatePermissions/${projectId}`,\r\n      {\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n        body: JSON.stringify(data),\r\n      }\r\n    );\r\n    resp = yield resp.json();\r\n    if (resp.done) {\r\n      yield put(UpdateUserInProjectSuccess(resp.message));\r\n      yield delay(500);\r\n      yield put(fetchCurrentProjectStart(projectId));\r\n    } else {\r\n      yield put(UpdateUserInProjectFailure(resp.message));\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n}\r\n\r\nexport function* updatePublishedInProject() {\r\n  try {\r\n    console.log(\"Inside update published saga\");\r\n    let projectId = yield select(selectCurrentProjectId);\r\n    let resp = yield fetch(`http://127.0.0.1:5000/publish/${projectId}`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    });\r\n    resp = yield resp.json();\r\n    if (resp.done) {\r\n      yield put(UpdatePublishedInProjectSuccess(resp.message));\r\n      yield delay(500);\r\n      yield put(fetchCurrentProjectStart(projectId));\r\n    } else {\r\n      yield put(UpdatePublishedInProjectFailure(resp.message));\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n}\r\n\r\nexport function* updateRoles({payload}){\r\n  try {\r\n    let data = payload\r\n    let projectId = yield select(selectCurrentProjectId);\r\n    let resp = yield fetch(`http://127.0.0.1:5000/updateRoles/${projectId}`, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(data)\r\n    });\r\n    resp = yield resp.json();\r\n    if (resp.done) {\r\n      yield put(UpdateRolesInProjectSuccess(resp.message));\r\n      yield delay(500);\r\n      yield put(fetchCurrentProjectStart(projectId));\r\n    } else {\r\n      yield put(UpdateRolesInProjectFailure(resp.message));\r\n    }\r\n  } catch (error) {\r\n    console.log(error)\r\n  }\r\n}\r\n\r\nexport function* onCurrentProjectFetchStart() {\r\n  yield takeLatest(\r\n    CurrentProjectActionTypes.FETCH_CURRENT_PROJECT_START,\r\n    fetchCurrentProject\r\n  );\r\n}\r\n\r\nexport function* onCurrentProjectDeleteStart() {\r\n  yield takeLatest(\r\n    CurrentProjectActionTypes.DELETE_CURRENT_PROJECT_START,\r\n    deleteCurrentProject\r\n  );\r\n}\r\n\r\nexport function* onInviteUserStart() {\r\n  yield takeLatest(CurrentProjectActionTypes.INVITE_USER_START, inviteUser);\r\n}\r\n\r\nexport function* onUpdateUserStart() {\r\n  yield takeLatest(\r\n    CurrentProjectActionTypes.UPDATE_USER_IN_PROJECT_START,\r\n    updateUserInProject\r\n  );\r\n}\r\n\r\nexport function* onDeleteUserStart() {\r\n  yield takeLatest(\r\n    CurrentProjectActionTypes.DELETE_USER_START,\r\n    deleteUser\r\n  );\r\n}\r\n\r\nexport function* onUpdateRolesStart(){\r\n  yield takeLatest(\r\n    CurrentProjectActionTypes.UPDATE_ROLES_IN_PROJECT_START,\r\n    updateRoles\r\n  )\r\n}\r\n\r\nexport function* onUpdatePublishedStart() {\r\n  yield takeLatest(\r\n    CurrentProjectActionTypes.UPDATE_PUBLISHED_IN_PROJECT_START,\r\n    updatePublishedInProject\r\n  );\r\n}\r\n\r\nexport function* currentProjectSagas() {\r\n  yield all([\r\n    call(onCurrentProjectFetchStart),\r\n    call(onCurrentProjectDeleteStart),\r\n    call(onInviteUserStart),\r\n    call(onUpdateUserStart),\r\n    call(onUpdatePublishedStart),\r\n    call(onUpdateRolesStart),\r\n    call(onDeleteUserStart)\r\n  ]);\r\n}\r\n"]},"metadata":{},"sourceType":"module"}